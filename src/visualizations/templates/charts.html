{{define "charts"}}
<style>
    .charts-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 2rem;
        margin-bottom: 3rem;
    }

    .chart-box {
        background: #f8f9fa;
        padding: 1.5rem;
        border-radius: 12px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .chart-title {
        font-size: 1.2rem;
        color: #333;
        margin-bottom: 1rem;
        text-align: center;
    }

    @media (max-width: 768px) {
        .charts-container {
            grid-template-columns: 1fr;
        }
    }
</style>
<div class="section">
    <h2 class="section-title">ðŸ“ˆ Language Distribution</h2>
    <div class="charts-container">
        <div class="chart-box">
            <div class="chart-title">Files by Language</div>
            <canvas id="languagePieChart"></canvas>
        </div>
        <div class="chart-box">
            <div class="chart-title">File Count Comparison</div>
            <canvas id="languageBarChart"></canvas>
        </div>
    </div>
</div>
<script>
    // Language distribution data
    const languageData = JSON.parse('{{toJSON .Analysis.Summary.Languages}}');
    const languageLabels = Object.keys(languageData);
    const languageCounts = Object.values(languageData);

    // Color palette
    const colors = [
        '#667eea', '#764ba2', '#f093fb', '#4facfe',
        '#43e97b', '#fa709a', '#fee140', '#30cfd0',
        '#a8edea', '#fed6e3', '#c1dfc4', '#deab6d'
    ];

    // Pie Chart
    const pieCtx = document.getElementById('languagePieChart').getContext('2d');
    new Chart(pieCtx, {
        type: 'pie',
        data: {
            labels: languageLabels,
            datasets: [{
                data: languageCounts,
                backgroundColor: colors,
                borderWidth: 2,
                borderColor: '#fff'
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'bottom',
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            const label = context.label || '';
                            const value = context.parsed || 0;
                            const total = context.dataset.data.reduce((a, b) => a + b, 0);
                            const percentage = ((value / total) * 100).toFixed(1);
                            return label + ': ' + value + ' files (' + percentage + '%)';
                        }
                    }
                }
            }
        }
    });

    // Bar Chart
    const barCtx = document.getElementById('languageBarChart').getContext('2d');
    new Chart(barCtx, {
        type: 'bar',
        data: {
            labels: languageLabels,
            datasets: [{
                label: 'Number of Files',
                data: languageCounts,
                backgroundColor: colors,
                borderWidth: 0,
                borderRadius: 8
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        precision: 0
                    }
                }
            }
        }
    });
</script>
{{end}}